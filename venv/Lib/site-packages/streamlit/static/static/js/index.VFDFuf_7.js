import{r as a,E as C,_ as E,x as s,aC as k,aA as x,aD as z,aE as I,g as D,f as W,aF as m,l,j as r,m as H,S as B,T as N,P as O,o as P,ax as X,aG as q,aH as T,aI as F}from"./index.CqTPbV5Y.js";import{e as j,S as G,a as U,b as J}from"./embed.HKcgTiLB.js";import"./threshold.Q1mXg5rX.js";import"./value.B4vHRSi7.js";import"./timer.C2hYhUse.js";var A=a.forwardRef(function(e,t){var i={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return a.createElement(C,E({iconAttrs:i,iconVerticalAlign:"middle",iconViewBox:"0 0 24 24"},e,{ref:t}),a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),a.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}))});A.displayName="ArrowDownward";var b=a.forwardRef(function(e,t){var i={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return a.createElement(C,E({iconAttrs:i,iconVerticalAlign:"middle",iconViewBox:"0 0 24 24"},e,{ref:t}),a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),a.createElement("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}))});b.displayName="ArrowUpward";const K=s("div",{target:"exsm2dv0"})(({theme:e,showBorder:t})=>({height:"100%",...t&&{border:`${e.sizes.borderWidth} solid ${e.colors.borderColor}`,borderRadius:e.radii.default,overflow:"hidden"}})),Q=s("div",{target:"exsm2dv1"})(({theme:e,showBorder:t})=>({...t&&{padding:`calc(${e.spacing.lg} - ${e.sizes.borderWidth})`}})),Y=s("div",{target:"exsm2dv2"})(({theme:e,showBorder:t})=>({marginTop:t?void 0:e.spacing.lg,marginBottom:t?e.spacing.twoXL:void 0})),w=s("div",{target:"exsm2dv3"})(({theme:e})=>({overflowWrap:"normal",textOverflow:"ellipsis",width:"100%",overflow:"hidden",whiteSpace:"nowrap",fontFamily:e.genericFonts.bodyFont,lineHeight:"normal",verticalAlign:"middle","& > div":{overflow:"hidden","& > p":{textOverflow:"ellipsis",overflow:"hidden"}}})),Z=s(k,{target:"exsm2dv4"})(({visibility:e})=>({marginBottom:0,display:e===x.Collapsed?"none":"grid",gridTemplateColumns:e===x.Collapsed?"initial":"auto 1fr",visibility:e===x.Hidden?"hidden":"visible"})),ee=s("div",{target:"exsm2dv5"})(({theme:e})=>({fontSize:e.fontSizes.threeXL,color:e.colors.bodyText,paddingBottom:e.spacing.twoXS})),te=s("div",{target:"exsm2dv6"})(({theme:e,metricColor:t,showArrow:i})=>({color:I(e,t),backgroundColor:z(e,t),fontSize:e.fontSizes.sm,display:"inline-flex",flexDirection:"row",alignItems:"center",fontWeight:e.fontWeights.normal,borderRadius:e.radii.full,maxWidth:"100%",padding:`${e.spacing.threeXS} ${e.spacing.xs} ${e.spacing.threeXS} ${e.spacing.xs}`,...i&&{paddingLeft:e.spacing.twoXS}})),ie=1e3;function ae(e,t,i,o,f){const n=`metric_chart_${Math.random().toString(36).slice(2,10)}`,h=e.length===1?[e[0],e[0]]:e,d={$schema:"https://vega.github.io/schema/vega-lite/v5.json",width:Math.round(i),height:Math.round(F("3.5rem")),data:{values:h.map((v,g)=>({x:g,y:v}))},layer:[{name:`${n}_mark`,mark:{type:"line",...t===m.ChartType.LINE&&{type:"line",strokeCap:"round",strokeWidth:2},...t===m.ChartType.BAR&&{type:"bar",cornerRadius:parseFloat(o.radii.full)},...t===m.ChartType.AREA&&{type:"area",color:z(o,f),opacity:1,line:{color:T(o,f),opacity:1,strokeWidth:2,strokeCap:"round"}}},encoding:{x:{field:"x",type:"quantitative",axis:null,scale:{zero:!1,nice:!1}},y:{field:"y",type:"quantitative",axis:null,scale:{zero:!1,nice:!1}}}},{name:`${n}_points`,mark:{type:"point",opacity:0},encoding:{x:{field:"x",type:"quantitative",axis:null,scale:{zero:!1,nice:!1}},y:{field:"y",type:"quantitative",axis:null,scale:{zero:!1,nice:!1}}},params:[{name:`${n}_hover_selection`,select:{type:"point",encodings:["x"],nearest:!0,on:e.length>ie?"mousemove{16}":"mousemove",clear:"mouseleave"}}]},{name:`${n}_highlighted_points`,transform:[{filter:{param:`${n}_hover_selection`,empty:!1}}],mark:{type:"point",filled:!0,size:65,tooltip:!0},encoding:{x:{field:"x",type:"quantitative",axis:null,scale:{zero:!1,nice:!1}},y:{field:"y",type:"quantitative",axis:null,scale:{zero:!1,nice:!1}}}}],config:{view:{stroke:null},padding:{left:-3,right:-3,top:2,bottom:2},...t===m.ChartType.BAR&&{padding:{left:0,right:0,top:2,bottom:2}},mark:{tooltip:{content:"encoding"},color:T(o,f)}}};return d.config=U(d.config,o),d}function oe({element:e}){const t=D(),i=a.useRef(null),{width:o,elementRef:f}=W(),{MetricDirection:u}=m,{body:n,label:h,delta:d,direction:v,color:g,labelVisibility:L,help:M,showBorder:y,chartData:c,chartType:S}=e;let p=null;switch(v){case u.DOWN:p=A;break;case u.UP:p=b;break}const $="0 threeXS 0 0",R=d!=="";return a.useEffect(()=>{if(c&&c.length>0&&i.current&&o>0){const V=ae(c,S,o,t,g);j(i.current,V,{actions:!1,renderer:"svg",ast:!0,expr:J,tooltip:{theme:"custom",formatTooltip:_=>`${_.y}`}})}},[c,g,t,o,S,i]),l(K,{className:"stMetric","data-testid":"stMetric",showBorder:y,children:[l(Q,{showBorder:y,children:[l(Z,{"data-testid":"stMetricLabel",visibility:H(L?.value),children:[r(w,{children:r(B,{source:h,allowHTML:!1,isLabel:!0})}),M&&r(P,{children:r(N,{content:M,placement:O.TOP_RIGHT})})]}),r(ee,{"data-testid":"stMetricValue",children:l(w,{children:[" ",n," "]})}),R&&l(te,{"data-testid":"stMetricDelta",metricColor:g,showArrow:p!==null,children:[p&&r(X,{testid:p===b?"stMetricDeltaIcon-Up":"stMetricDeltaIcon-Down",content:p,size:"md",margin:$}),l(w,{children:[" ",d," "]})]})]}),c&&c.length>0&&l("div",{ref:f,children:[r(q,{styles:[G]}),r(Y,{ref:i,"data-testid":"stMetricChart",showBorder:y})]})]})}const ce=a.memo(oe);export{ce as default};
